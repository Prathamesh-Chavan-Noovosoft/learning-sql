# DVD Rental Exercise

Write queries in postgreSQL for each task given below.

## Schema

![img.png](img.png)

## Questions

### Question 1

Write an SQL Query to return the last rented film of every customer, that has rented a movie

### Question 2

Can you calculate the number of films rented by them in a certain category (given as input) for a Specific user (also
given as input).

### Question 3

Can you calculate the percentage of total revenue each film is generating for each month

1. For All years
2. For an User defined year.

### Question 4

For Each film, Find the No of customers who rented it from

1. India
2. Every Country
3. Find the No of staff members in country for every film rented

### Question 5

Can you find a way to calculate the total payment amount for each customer considering their entire rental history?

### Question 6

How would you manipulate the email data from the customer table and filter results based on this manipulated string?

### Question 7

Can you calculate the number of rentals per day? You might need to use date and timestamp functions, join multiple
tables, and group the final result by date.

### Question 8

How would you create subtotals and grand totals of rentals per category per customer? You might need to use the ROLLUP
operator and join multiple tables.

### Question 9

Can you join multiple tables and use a subquery in the WHERE clause that aggregates the total payment amount per
customer?

### Question 10

How would you combine the total payment amount per customer with the total rental amount per customer? You might need to
use the UNION operator, join multiple tables, and aggregate the amounts.

### Question 11

Can you categorize customers based on their total payment amount? You might need to use the CASE statement, join
multiple tables, and group the final result by category.

### Question 12

Write a query that calculates the total payment amount per customer per category, with subtotals and grand totals, and
filters results based on a full text search of the film description.