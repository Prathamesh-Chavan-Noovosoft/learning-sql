# DVD Rental Exercise

Write queries in postgreSQL for each task given below.

## Schema

![img.png](img.png)

# My Questions

## Questions

### Question 1

Write an SQL Query to return the last rented film of every customer, that has rented a movie

### Question 2

Can you calculate the number of films rented by them in a certain category (given as input) for a Specific user (also
given as input).

### Question 3

Can you calculate the percentage of total revenue each film is generating for each month

1. For All years
2. For an User defined year.

### Question 4

For Each film, Find the No of customers who rented it from

1. India
2. Every Country
3. Find the No of staff members in country for every film rented

### Question 5

Can you find a way to calculate the total payment amount for each customer considering their entire rental history?

### Question 6

Can you categorize customers based on their total payment amount? categorize them as A, B and C depending on their total spending

### Question 7

Can you calculate the number of rentals per day, month, year?

### Question 8

Write a query that calculates the total payment amount per customer per category, with subtotals and grand totals, and
filters results based on a full text search of the film description.

### Question 9

How would you create subtotals and grand totals of rentals per category per customer?

### Question 10

Write a query to calculate the staff employee & their manager who handled most customers for each store.

# Shreyas's Questions

### Question 1:

Write a SQL query to retrieve all films with a rental rate higher than $2, sorted by title.

### Question 2:

Create a SQL query that lists customers and the number of rentals they have made, ordered by the number of rentals in descending order.

### Question 3:

Write a SQL query to find all actors who have appeared in more than 15 films, including the titles of these films.

### Question 4:

Create a SQL query that retrieves the total payment amount received by each staff member, ordered by total payment amount in descending order.

### Question 5:

Write a SQL query to list all cities and their respective countries where there are more than 10 customers residing.

### Question 6:

Write a SQL query to retrieve all films that are available in more than 5 stores, including the store IDs.

### Question 7:

Create a SQL query that lists all staff members and the total number of rentals processed by each, ordered by the total number of rentals in descending order.

### Question 8:

Write a SQL query to find all customers who have rented films but have not made any payments, including their customer ID and name.

### Question 9:

Create a SQL query that retrieves all films that have not been rented out and are not present in any inventory.

### Question 10:

Write a SQL query to list all countries with more than three stores operating, including the country name and number of stores.

# Abhishek's Questions

### Q1 -

Write a query to find out an actor full name along with the total number of films actor have worked in order by fullName of actor

### Q2 -

Write a query to fetch the full name of the actor 'Penelope Guiness' along with the title of movies actor have worked in and category of each movie

### Q3 -

Write a query to fetch all movies with revenue more than average revenue

### Q4 -

Write a query to extract the for a particular movie how much percent of revenue it made district wise order by district name

### Q5 -

Write a query to find out monthly revenue of a particular movie order by highest to lowest revenue

### Q6 -

Write a query to find out number of staff members belonging to country

### Q7 -

Write a query to calculate total revenue generated by staff and order by staff

### Q8 -

Write a query to find full name of every actor along with number of movies actor made order in descending order of movies a actor made

### Q9 -

Create al list of each customer's full name, total payment customer has done and classify them as silver, gold, platinum according to their total payment

### Q10 -

Write a query to find number of movies made in each category in descending order of number of movies
